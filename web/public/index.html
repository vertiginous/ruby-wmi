<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<title>ruby-wmi -- WMI queries, easier</title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="css/toader.css"/>
<link rel="stylesheet" type="text/css" href="css/lazy.css"/>
</head>
<body>

<div id="header">
		<div id="masthead">
			<h1>ruby-wmi</h1>
			<p>WMI queries, easier</p>
			<ul>
				<li><a href="#"><strong>Home</strong></a></li>
				<li><a href="doc/"><strong>Docs</strong></a></li>
				<li><a href="http://rubyforge.org/projects/ruby-wmi/"><strong>Get</strong></a></li>
				<!-- <li><a href="#"><strong>About</strong></a></li> -->
			</ul>
		</div>
</div>

<div id="main">
	<div id="content">
		<div class="article">
         <h2>What is it?</h2>
         <p><a href="http://ruby-wmi.rubyforge.org/">ruby-wmi</a> is an <a href="http://api.rubyonrails.org/classes/ActiveRecord/Base.html">ActiveRecord</a> style interface for Microsoft's Windows
          Management Instrumentation provider.
          </p>
          <p>Many of the methods in WMI::Base are borrowed directly, or with some
          modification from <a href="http://api.rubyonrails.org/classes/ActiveRecord/Base.html">ActiveRecord</a>.
          </p>
          <p>The major tool in this library is the #find method.  For more
          information, see WMI::Base.
          </p>
          <p>There is also a WMI.sublasses method included for reflection.</p>


		</div>
		<div class="article">
            <ul>
            <li>samples/disk.rb
              <blockquote>
                  <pre class="lazy"><span class="Keyword">require</span> <span class="String"><span class="String">'</span>ruby-wmi<span class="String">'</span></span>

disks <span class="Keyword">=</span> <span class="Variable">WMI</span>::<span class="Entity">Win32_LogicalDisk</span>.<span class="Entity">find</span>(<span class="Constant"><span class="Constant">:</span>all</span>)

disks.<span class="Entity">each</span> <span class="Keyword">do </span>|<span class="Variable">disk</span>|
 disk.<span class="Entity">properties_</span>.<span class="Entity">each</span> <span class="Keyword">do </span>|<span class="Variable">p</span>|
    puts <span class="String"><span class="String">&quot;</span><span class="String"><span class="String">#{</span>p<span class="String"><span class="String">.</span><span class="Entity">name</span></span><span class="String">}</span></span>: <span class="String"><span class="String">#{</span>disk<span class="String">[</span>p<span class="String"><span class="String">.</span><span class="Entity">name</span></span><span class="String">]</span><span class="String">}</span></span><span class="String">&quot;</span></span>
  <span class="Keyword">end</span>
<span class="Keyword">end</span>
</pre>
              </blockquote>
            </li>
          </ul>
            <ul>
            <li>samples/logoff.rb
              <blockquote>
                  <pre class="lazy"><span class="Keyword">require</span> <span class="String"><span class="String">'</span>ruby-wmi<span class="String">'</span></span>

<span class="Variable">LOGOFF</span> <span class="Keyword">=</span> <span class="Constant">0</span>

host <span class="Keyword">=</span> <span class="String"><span class="String">'</span>computername<span class="String">'</span></span>
host <span class="Keyword">=</span> <span class="Variable">WMI</span>::<span class="Entity">Win32_OperatingSystem</span>.<span class="Entity">find</span>(<span class="Constant"><span class="Constant">:</span>first</span>, <span class="Constant"><span class="Constant">:</span>conditions</span> =&gt; {<span class="Constant"><span class="Constant">:</span>primary</span> =&gt; <span class="Constant">true</span>}, <span class="Constant"><span class="Constant">:</span>host</span> =&gt; host)
host.<span class="Entity">win32shutdown</span>(<span class="Variable">LOGOFF</span>)

</pre>
              </blockquote>
            </li>
          </ul>
            <ul>
            <li>samples/memory.rb
              <blockquote>
                  <pre class="lazy"><span class="Keyword">require</span> <span class="String"><span class="String">'</span>ruby-wmi<span class="String">'</span></span>

properties <span class="Keyword">=</span> [<span class="String"><span class="String">'</span>Description<span class="String">'</span></span>,<span class="String"><span class="String">'</span>MaxCapacity<span class="String">'</span></span>,<span class="String"><span class="String">'</span>MemoryDevices<span class="String">'</span></span>,<span class="String"><span class="String">'</span>MemoryErrorCorrection<span class="String">'</span></span>]


mem <span class="Keyword">=</span> <span class="Variable">WMI</span>::<span class="Entity">Win32_PhysicalMemoryArray</span>.<span class="Entity">find</span>(<span class="Constant"><span class="Constant">:</span>all</span>, <span class="Constant"><span class="Constant">:</span>host</span> =&gt; <span class="String"><span class="String">'</span>server1<span class="String">'</span></span>)
mem.<span class="Entity">each</span>{|<span class="Variable">i</span>| puts properties.<span class="Entity">map</span>{|<span class="Variable">p</span>| <span class="String"><span class="String">&quot;</span><span class="String"><span class="String">#{</span>p<span class="String">}</span></span>: <span class="String"><span class="String">#{</span>i<span class="String">[</span>p<span class="String">]</span><span class="String">}</span></span><span class="String">&quot;</span></span>}}

mem2 <span class="Keyword">=</span> <span class="Variable">WMI</span>::<span class="Entity">Win32_PhysicalMemoryArray</span>.<span class="Entity">find</span>(<span class="Constant"><span class="Constant">:</span>all</span>, {<span class="Constant"><span class="Constant">:</span>host</span> =&gt; <span class="String"><span class="String">'</span>server2<span class="String">'</span></span>, <span class="Constant"><span class="Constant">:</span>user</span> =&gt; <span class="String"><span class="String">'</span>domain<span class="Constant">\\</span>gordon<span class="String">'</span></span>, <span class="Constant"><span class="Constant">:</span>passwd</span> =&gt; <span class="String"><span class="String">'</span>password<span class="String">'</span></span>} )
mem2.<span class="Entity">each</span>{|<span class="Variable">i</span>| puts properties.<span class="Entity">map</span>{|<span class="Variable">p</span>| <span class="String"><span class="String">&quot;</span><span class="String"><span class="String">#{</span>p<span class="String">}</span></span>: <span class="String"><span class="String">#{</span>i<span class="String">[</span>p<span class="String">]</span><span class="String">}</span></span><span class="String">&quot;</span></span>}}

</pre>
              </blockquote>
            </li>
          </ul>
		</div>

</div>

<!-- Footer -->

	<div id="footer">

    <ul>
      <li>&copy; 2008 Gordon Thiesfeld</li>
      <li><a href="http://www.gorotron.com">CSS Template</a> by <a href="http://www.gorotron.com">gorotron</a>, modified by Gordon Thiesfeld.</li>
    </ul>

  </div>
